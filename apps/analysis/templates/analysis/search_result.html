{% extends "base.html" %}
{% block title %}Report{% endblock %}
{% block content %}
<br>
<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 column">
			<h3>基因信息</h3>
			<div class="container">
				<div class="row clearfix">
					<div class="col-md-12 column">
						<dl class="dl-horizontal">
							<dt>基因名称</dt>
							<dd><a href="http://www.ncbi.nlm.nih.gov/gene/{{ basic_gene_info.gene_id }}" target="_blank">{{ basic_gene_info.gene_symbol }}</a></dd>
							<dt>系统命名法全称</dt>
							<dd>{{ basic_gene_info.full_name_from_nomenclature_authority }}</dd>
							<dt>别名</dt>
							<dd>{{ basic_gene_info.synonyms }}</a></dd>
							<dt>其他数据库ID</dt>
							<dd>{{ basic_gene_info.db_xrefs }}</dd>
							<dt>基因组定位</dt>
							<dd>{{ basic_gene_info.map_location }}</dd>
							{% if gene_info %}
							<dt>基因功能描述</dt>
							<dd>{{ gene_info.gene_description_chinese }}</dd>
							<dt>Pathway</dt>
							<dd><a href="https://www.kegg.jp/kegg-bin/search_pathway_text?map=map&mode=1&viewImage=true&keyword={{gene_info.gene_name}}" target="_blank">KEGG Link</a></dd>
								{% if gene_info.pathway_website %}<dt>视频讲解</dt>
								<dd><a href="{{ gene_info.pathway_website }}" target="_blank"><span class="glyphicon glyphicon-film"></span></a></dd>
								{% endif %}
							{% endif %}

							<!--基因疾病注释部分开始-->
							{% if gene_disease_info %}
								{% for gene_disease in gene_disease_info %}
								<dt>{{ gene_disease.gene }}与{{ gene_disease.do }}</dt>
								<dd>{{ gene_disease.annotation_chinese }}</dd>
								{% endfor %}
							{% endif %}
							<!--基因疾病注释部分结束-->
						</dl>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row clearfix">
		<h3>基因变异信息</h3>
		<div class="col-md-12 column">
			<h4>变异基本信息</h4>
			<table class="table table-hover table-striped">
				<tbody>
				{% if variant_info %}
					<tr>
						<td>变异</td>
						<td>{{ variant_info.gene_variant }}</td>
						<td>转录本</td>
						<td>{{ variant_info.reference_genome_version }}</td>
					</tr>
					<tr>
						<td>HGVS_cds</td>
						<td>{{ variant_info.hgvs_cds }}</td>
						<td>HGVS_pep</td>
						<td>{{ variant_info.hgvs_pep }}</td>
					</tr>
						<td>染色体位置</td>
						<td>{{ variant_info.mutation_location}}</td>
						<td>功能影响预测</td>
						<td>{{ variant_info.fathmm_score }}</td>
					</tr>
				{% endif %}
				</tbody>
			</table>
		</div>
		<div class="col-md-12 column">
			<h4>变异生化功能解读</h4>
			<p>
				{% if variant_desc %}
					{% for item in variant_desc %}
					{{ item.description_chinese }}
					{% endfor %}
				{% else %}
					该变异在OncoView中暂未解读，我们会尽快收录并解读该变异，如果您有更多需求，请直接给我们发送邮件或电话联系我们。感谢您使用OncoView数据库。
				{% endif %}
			</p>
		</div>
	</div>
	<div class="row clearfix">
		<div class="col-md-12 column">
			<h3>用药提示信息</h3>
			{% if not user.has_paid %}<p class="help">您现在的状态为普通用户，您可以选择升级账号，以获取全部内容。</p>{% endif %}
			<h4>该变异在所查询癌种中的研究结果</h4>
			<table class="table table-hover table-striped ">
				{% if annotation %}
				<thead>
					<tr>
						<th>基因变异</th>
						<th>癌种</th>
						<th>药物</th>
						<th>研究结果</th>
						<th>证据种类</th>
						<th>证据等级</th>
						<th>证据分期</th>
						<th>参考文献</th>
					</tr>
				</thead>
				<tbody>
				{% for anno in annotation %}
					<tr>
						<td>{{ anno.gene_variant }}</td>
						<td>{{ anno.disease }}</td>
						<td>
							{% if anno.evidence_type.evidence_type == 'treatment' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.drug}}</a></td>
							{% else %} None {% endif %}
						<td>{{ anno.annotation_chinese }}</td>
						<td>{{ anno.relationship }}</td>
						<td>{{ anno.evidence_ranking }}</td>
						<td>{% if anno.evidence_phase.evidence_phase == 'Approved' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.evidence_phase }}</a>{% else %}{{ anno.evidence_phase }}{% endif %}</td>
						<td>
							{% for ref in anno.variant_drug_annotation_ref.all %}
							<span><a href="{% url 'reports:reference_details' ref.reference_id %}" target="_blank">
								{% if ref.pmid %}{{ ref.pmid }}{% else %}详情{% endif %}
							</a></span>
							{% endfor %}
						</td>
					</tr>
				{% endfor %}
				</tbody>
			{% endif %}
			</table>

			{% if parent_variant_annotation %}
			<h4>该变异相关变异研究结果</h4>
			<table class="table table-hover table-striped ">
				<thead>
					<tr>
						<th>基因变异</th>
						<th>癌种</th>
						<th>药物</th>
						<th>研究结果</th>
						<th>证据种类</th>
						<th>证据等级</th>
						<th>证据分期</th>
						<th>参考文献</th>
					</tr>
				</thead>
				<tbody>
				{% for anno in parent_variant_annotation %}
					<tr>
						<td>{{ anno.gene_variant }}</td>
						<td>{{ anno.disease }}</td>
						<td>
							{% if anno.evidence_type.evidence_type == 'treatment' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.drug}}</a>
							{% else %} None {% endif %}
						</td>
						<td>{{ anno.annotation_chinese }}</td>
						<td>{{ anno.relationship }}</td>
						<td>{{ anno.evidence_ranking }}</td>
						<td>{% if anno.evidence_phase.evidence_phase == 'Approved' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.evidence_phase }}</a>{% else %}{{ anno.evidence_phase }}{% endif %}</td>
						<td>
							{% for ref in anno.variant_drug_annotation_ref.all %}
							<span><a href="{% url 'reports:reference_details' ref.reference_id %}" target="_blank">
								{% if ref.pmid %}{{ ref.pmid }}{% else %}详情{% endif %}
							</a></span>
							{% endfor %}
						</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
			{% endif %}


			{% if related_annotation %}
			<h4>该变异在其他癌种中的研究结果</h4>
			<table class="table table-hover table-striped ">
				<thead>
					<tr>
						<th>基因变异</th>
						<th>癌种</th>
						<th>药物</th>
						<th>研究结果</th>
						<th>证据种类</th>
						<th>证据等级</th>
						<th>证据分期</th>
						<th>参考文献</th>
					</tr>
				</thead>
				<tbody>
				{% for anno in related_annotation %}
					<tr>
						<td>{{ anno.gene_variant }}</td>
						<td>{{ anno.disease }}</td>
						<td>
							{% if anno.evidence_type.evidence_type == 'treatment' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.drug}}</a>
							{% else %} None {% endif %}
						</td>
						<td>{{ anno.annotation_chinese }}</td>
						<td>{{ anno.relationship }}</td>
						<td>{{ anno.evidence_ranking }}</td>
						<td>{% if anno.evidence_phase.evidence_phase == 'Approved' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.evidence_phase }}</a>{% else %}{{ anno.evidence_phase }}{% endif %}</td>
						<td>
							{% for ref in anno.variant_drug_annotation_ref.all %}
							<span><a href="{% url 'reports:reference_details' ref.reference_id %}" target="_blank">
								{% if ref.pmid %}{{ ref.pmid }}{% else %}详情{% endif %}
							</a></span>
							{% endfor %}
						</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
			{% endif %}
		</div>
	</div>
</div>
{% endblock%}
