{% extends "base.html" %}
{% block title %}Report{% endblock %}
{% block content %}
<br>
<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 column">
			<h3>基因信息</h3>
			<div class="container">
				<div class="row clearfix">
					<div class="col-md-12 column">
						<dl class="dl-horizontal">
							<dt>基因名称</dt>
							<dd><a href="http://www.ncbi.nlm.nih.gov/gene/{{ basic_gene_info.gene_id }}" target="_blank">{{ basic_gene_info.gene_symbol }}</a></dd>
							<dt>系统命名法全称</dt>
							<dd>{{ basic_gene_info.full_name_from_nomenclature_authority }}</dd>
							<dt>别名</dt>
							<dd>{{ basic_gene_info.synonyms }}</a></dd>
							<dt>其他数据库ID</dt>
							<dd>{{ basic_gene_info.db_xrefs }}</dd>
							<dt>基因组定位</dt>
							<dd>{{ basic_gene_info.map_location }}</dd>
							{% if gene_info %}
							<dt>基因功能描述</dt>
							<dd>{{ gene_info.gene_description_chinese }}</dd>
							<dt>Pathway</dt>
							<dd><a href="https://www.kegg.jp/kegg-bin/search_pathway_text?map=map&mode=1&viewImage=true&keyword={{gene_info.gene_name}}" target="_blank">KEGG Link</a></dd>
								{% if gene_info.pathway_description_chinese %}<dt>视频讲解</dt>
								<dd><a href="{{ gene_info.pathway_description_chinese }}" target="_blank"><span class="glyphicon glyphicon-film"></span></a></dd>
								{% endif %}
							{% endif %}
						</dl>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row clearfix">
		<h3>变异信息</h3>
		<div class="col-md-6 column">
			<table class="table table-hover table-striped">
				<tbody>
				{% if variant_info %}
					<tr>
						<td>变异</td>
						<td>{{ variant_info.gene_variant }}</td>
						<td>转录本</td>
						<td>{{ variant_info.reference_genome_version }}</td>
					</tr>
					<tr>
						<td>HGVS_cds</td>
						<td>{{ variant_info.hgvs_cds }}</td>
						<td>HGVS_pep</td>
						<td>{{ variant_info.hgvs_pep }}</td>
					</tr>
						<td>染色体位置</td>
						<td>{{ variant_info.mutation_location}}</td>
						<td>功能影响预测</td>
						<td>{{ variant_info.fathmm_score }}</td>
					</tr>
				{% endif %}
				</tbody>
			</table>
		</div>
		<div class="col-md-6 column">
			<p>
				 {% if variant_desc %}{{ variant_desc.description_chinese }}{% endif %}
			</p>
		</div>
	</div>
	<div class="row clearfix">
		<div class="col-md-12 column">
			<h3>用药提示信息</h3>
			<h4>该变异在所查询癌种中的研究结果</h4>
			<table class="table table-hover table-striped ">
				{% if annotation %}
				<thead>
					<tr>
						<th>基因变异</th>
						<th>癌种</th>
						<th>药物</th>
						<th>研究结果</th>
						<th>证据种类</th>
						<th>证据等级</th>
						<th>证据分期</th>
						<th>参考文献</th>
					</tr>
				</thead>
				<tbody>
				{% for anno in annotation %}
					<tr>
						<td>{{ anno.gene_variant }}</td>
						<td>{{ anno.disease }}</td>
						<td><a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.drug}}</a></td>
						<td>{{ anno.annotation_chinese }}</td>
						<td>{{ anno.relationship }}</td>
						<td>{{ anno.evidence_ranking }}</td>
						<td>{% if anno.evidence_phase.evidence_phase == 'Approved' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.evidence_phase }}</a>{% else %}{{ anno.evidence_phase }}{% endif %}</td>
						<td>
							{% for ref in anno.variant_drug_annotation_ref.all %}
							<span><a href="{% url 'reports:reference_details' ref.reference_id %}" target="_blank">
								{% if ref.pmid %}{{ ref.pmid }}{% else %}详情{% endif %}
							</a></span>
							{% endfor %}
						</td>
					</tr>
				{% endfor %}
				</tbody>
			{% endif %}
			</table>
			{% if related_annotation %}
			<h4>该变异在其他癌种中的研究结果</h4>
			<table class="table table-hover table-striped ">
				<thead>
					<tr>
						<th>基因变异</th>
						<th>癌种</th>
						<th>药物</th>
						<th>研究结果</th>
						<th>证据种类</th>
						<th>证据等级</th>
						<th>证据分期</th>
						<th>参考文献</th>
					</tr>
				</thead>
				<tbody>
				{% for anno in related_annotation %}
					<tr>
						<td>{{ anno.gene_variant }}</td>
						<td>{{ anno.disease }}</td>
						<td><a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.drug}}</a></td>
						<td>{{ anno.annotation_chinese }}</td>
						<td>{{ anno.relationship }}</td>
						<td>{{ anno.evidence_ranking }}</td>
						<td>{% if anno.evidence_phase.evidence_phase == 'Approved' %}<a href="{% url 'reports:drug_details' anno.drug.drug_id %}" target="_blank">{{ anno.evidence_phase }}</a>{% else %}{{ anno.evidence_phase }}{% endif %}</td>
						<td>
							{% for ref in anno.variant_drug_annotation_ref.all %}
							<span><a href="{% url 'reports:reference_details' ref.reference_id %}" target="_blank">
								{% if ref.pmid %}{{ ref.pmid }}{% else %}详情{% endif %}
							</a></span>
							{% endfor %}
						</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
			{% endif %}
		</div>
		<div class="col-md-12 column">
			<h4>没有想要的结果？请尝试搜索如下关键字：</h4>
			<dl class="dl-horizontal">
				{% if related_disease %}
				<dt>相关疾病：</dt>
				<dd>{% for disease in related_disease %}<li>{{ disease.is_a }}</li>{% endfor %}</dd>
				{% endif %}
				{% if related_variant %}
				<dt>相关变异：</dt>
				<dd>{% for item in related_variant %}<li>{{ item }}</li>{% endfor %}</dd>
				{% endif %}
			</dl>
		</div>
	</div>
</div>
{% endblock%}